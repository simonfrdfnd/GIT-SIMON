import requests
import sqlite3
from datetime import datetime

# Remplacez ces valeurs par les informations de votre instance ServiceNow
instance_url = "https://nexioprod.service-now.com"
username = "simon.froidefond@nexiogroup.com"
password = "Nexio171296SF"


# Construct the API URL with pagination parameters
api_url = f"{instance_url}/api/now/v2/table/incident"

params = {
    "sysparm_query": "number=INC0019894",
    "sysparm_display_value": "true"
}

# Add authentication information to the request header
headers = {
    "Content-Type": "application/json",
    "Accept": "application/json",
}
auth = (username, password)

# Make the GET request
response = requests.get(api_url, params=params, headers=headers, auth=auth)

# Check the response
if response.status_code == 200:
    # The request was successful, retrieve the data
    incident_data = response.json().get("result")
    for incident in incident_data:
        comments_and_work_notes = incident.get("comments_and_work_notes")
    print(comments_and_work_notes)